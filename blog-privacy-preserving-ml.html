<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>TUM.ai - Student Initiative focused on Artificial Intelligence</title>
    <meta name="description" content="TUM.ai is a student initiative working on Artificial intelligence (AI) located at the Technical University of Munich (TUM). We run AI projects with industry partners.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://tum-ai.com/assets/img/logo/Group28logo_large_no_border.png">
    <link rel="icon" type="image/png" sizes="800x800" href="assets/img/logo/Group%2014logo_small.png">
    <link rel="icon" type="image/png" sizes="800x800" href="assets/img/logo/Group%2014logo_small.png">
    <link rel="icon" type="image/png" sizes="800x800" href="assets/img/logo/Group%2014logo_small.png">
    <link rel="icon" type="image/png" sizes="800x800" href="assets/img/logo/Group%2014logo_small.png">
    <link rel="icon" type="image/png" sizes="800x800" href="assets/img/logo/Group%2014logo_small.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700">
    <link rel="stylesheet" href="assets/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/fonts/fontawesome5-overrides.min.css">
    <link rel="stylesheet" href="assets/css/styles.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.3.1/css/swiper.min.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-166440742-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-166440742-1');
</script>
</head>

<body>
    <div class="modal fade" role="dialog" tabindex="-1" id="modal1">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Contact TUM.ai</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col">
                            <div class="mx-auto testimonial-item mb-5 mb-lg-0"><img class="rounded-circle img-fluid mb-3" src="assets/img/logo/Group28logo_large_no_border.svg">
                                <h5>Your contact at TUM.ai</h5>
                                <p class="font-weight-light mb-0">TUM.ai Operations Team<br>Arcisstraße 21, 80333 München<br>contact@tum-ai.com</p>
                            </div>
                        </div>
                        <div class="col">
                            <form data-bss-recipient="43c9dff80f0b203240afd51702f87891"><form class="needs-validation" novalidate>
    <div class="form-row">
        <div class="col-md-6 mb-3">
            <label><strong>Name</strong></label>
            <input type="text" class="form-control" placeholder="" required minlength="1">
            <div class="invalid-feedback">
                Please enter your name.
            </div>
        </div>
        <div class="col-md-6 mb-3">
            <label><strong>Company</strong></label>
            <input type="text" class="form-control" placeholder="">
            <div class="invalid-feedback">
                Please enter your companies name.
            </div>
        </div>
    </div>
    <div class="form-row">
        <div class="col-md-6 mb-3">
            <label><strong>Email</strong></label>
            <input type="email" class="form-control" placeholder="">
            <div class="invalid-feedback">
                Please enter your email address.
            </div>
        </div>
        <div class="col-md-6 mb-3">
                        <label><strong>Phone</strong></label>
            <input type="text" class="form-control" placeholder="" required>
            <div class="invalid-feedback">
                Please enter your phone number.
            </div>
        </div>
    </div>

    <div class="form-row">
        <div class="col-md-12 mb-3">
            <label><strong>Message</strong></label>
            <textarea class="form-control" placeholder="" required minlength="1"></textarea>
            <div class="invalid-feedback">
                Please enter a message.
            </div>
        </div>
    </div>
    <button class="btn btn-primary align-right" type="submit">Submit</button>
    
</form>

<script>
// Example starter JavaScript for disabling form submissions if there are invalid fields
(function() {
  'use strict';
  window.addEventListener('load', function() {
    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.getElementsByClassName('needs-validation');
    // Loop over them and prevent submission
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();
</script></form>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <p class="text-right" style="margin: 0px;padding-top: 10px;">By submission you accept our&nbsp;<a href="impressum" style="font-size: 16px;">Terms &amp; Conditions</a>.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <nav class="navbar navbar-light navbar-expand-lg shadow navigation-clean-button sticky-top" style="font-family: Roboto, sans-serif;background-color: #ffffff;opacity: 0.95;height: 65px;padding-top: 0px;padding-left: 12px;padding-bottom: 0px;">
        <div class="container" style="background-color: transparent;"><a class="navbar-brand" style="padding: 0px;height: 65px;width: 180px;" href="/"><img src="assets/img/logo/Group28logo_large_no_border.svg" style="max-height: 100%;padding: 0px;margin-right: 0px;width: auto;height: 100%;"></a><button data-toggle="collapse" class="navbar-toggler" data-target="#navcol-1"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse text-center" id="navcol-1" style="background-color: #fff;opacity: 1;width: 100%;">
                <ul class="navbar-nav ml-auto" style="color: #fcfeff;">
                    <li class="nav-item"><a class="nav-link" href="activities" style="color: #191e20;font-family: Lato, sans-serif;font-weight: 800;padding: 12px 12px;font-size: 18px;">Activities</a></li>
                    <li class="nav-item"><a class="nav-link" href="forStudents" style="color: #191e20;font-family: Lato, sans-serif;font-weight: 800;padding: 12px 12px;font-size: 18px;">For Students</a></li>
                    <li class="nav-item"><a class="nav-link" href="aboutus" style="color: #191e20;font-family: Lato, sans-serif;font-weight: 800;padding: 12px 12px;font-size: 18px;">About Us</a></li>
                    <li class="nav-item"><a class="nav-link" href="forPartners" style="color: #191e20;font-family: Lato, sans-serif;font-weight: 800;padding: 12px 12px;font-size: 18px;">For Partners</a></li>
                    <li class="nav-item"><a class="nav-link" href="blog" style="color: #191e20;font-family: Lato, sans-serif;font-weight: 800;padding: 8px 16px 12px 8px;padding-top: 12px;font-size: 18px;">Blog</a></li>
                </ul><button class="btn btn-primary" data-toggle="modal" data-target="#modal1" type="button" style="margin: 5px 0px;font-family: Lato, sans-serif;font-size: 18px;">Contact</button>
            </div>
        </div>
    </nav>
    <div class="article-clean">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-xl-8 offset-lg-1 offset-xl-2">
                    <div class="intro">
                        <h1 class="text-center"><strong>Debugging without ever seeing the code</strong><br></h1>
                        <h3 class="text-center"><strong>Towards privacy in real-world machine learning.</strong><br></h3>
                        <p class="text-center"><span class="by">by</span> <a href="https://www.linkedin.com/in/nicolas-remerscheid/">NICOLAS REMERSCHEID</a><span class="date">October 16th, 2020</span></p>
                    </div>
                    <div class="text">
                        <p>Debugging. “Should I do it…., or could you….? You do it? I do it? Everybody needs to do it - in every domain. Be it finding an error in a text, checking the sensibility of a piece of software or, in this case, <strong>evaluating whether an AI model outputs what it should.</strong> Now, what does this&nbsp;have to do with privacy in machine learning, you might ask? Well, we also need to debug ML models that are trained on private data which we aren’t allowed to access directly. <br><em>But don’t I need direct access to the training data to debug a machine learning model?</em><br><br><strong>No, </strong>you don’t! Let me first give a quick introduction to the core technology that makes this possible: Privacy Preserving Machine Learning (PP-ML). <br>PP-ML is a rapidly evolving new subfield of Machine Learning which tries to enable algorithms to be trained on data that can’t be accessed directly, most often stored in a decentralized manner on multiple devices without the possibility of transferring it to a central place where our model sits. There have been remarkable advances in the development of techniques that allow to <strong><em>train</em></strong><em> on decentralized data</em> without directly accessing the data. <br><strong>However, we need the whole machine learning workflow from data-processing to model testing to be privacy preserving!</strong><br>Specifically, I will explain and further elaborate on an interesting approach to inspect data samples for debugging in a privacy preserving manner, outlined in the paper “Generative Models for Effective ML on Private, Decentralized Datasets”, by Sean Augustin et al. [1], published as a conference paper at ICLR 2020.<br>Before we deep dive into the proposed method to debug an AI model without accessing the data directly, the terms <em>Federated Learning, Differential Privacy </em>and<em> Deep Generative Models</em> should sound familiar. As a quick overview, let me very briefly summarize these.<br></p>
                        <figure style="margin-right: 0;margin-left: 0;width: 100%;"><img class="figure-img" src="assets/img/blog/blog-privacy-preserving-ml/privacy-img1.png"></figure>
                        <p>Deep-<strong>GM</strong> simply describe Deep Learning (DL) models which can be trained to generate artificial, new data samples. Normally we bring the data to the model to train, <strong>FL</strong> allows to train on multiple devices at the same time by bringing the model to the data - the data never leaves the device. ML-models tend to memorize certain parts of the data they’re trained on, to <em>prevent reverse engineering information about the data-examples</em>, here we use <strong>DP</strong> to add random noise to the model weights. <br>Lastly, before we take off, a bit of <strong>motivation for doing PP-ML</strong> - why should you even care about PP-ML? To shorten this discussion, let me give a very simple use-case as an example. There exists a skin-cancer model from a research team at Stanford in corporation with Google [5] which is capable of detecting whether you have skin-cancer simply by providing it with a photo of your skin. Remarkable accuracy, immediate feedback. However, would you want some big tech company to have a large store of your naked full-body scans on their cloud? No!<br></p>
                        <h2><strong>Debugging…what, exactly?</strong></h2>
                        <p>To further narrow down this issue, this blog post limits the challenge of debugging ML-models to the problem of <strong>manual data inspection</strong>. <em>Manual data inspection without direct data access would be like debugging code without actually seeing the code</em>.<br>Intuitively, the manual inspection of data samples can be used for two purposes, <strong>find flaws or mistakes in the dataset itself</strong> or <strong>discover errors in the data preprocessing</strong>. The mentioned other study from (Humbatova et al. 2019 [4]) also comes to the result that “Preprocessing of Training of Data” and “Training Data Quality” are one of the most common problems in DL.<br>The paper defines <strong>six concrete different problems</strong> (*) where in a normal scenario (non-PP-ML) a Machine Learning Engineer would manually inspect some data.<br>&nbsp; &nbsp; &nbsp; 1. Check whether the data is suited for the specific use-case.<br>&nbsp; &nbsp; &nbsp; 2. Understand which samples are misclassified and why.<br>&nbsp; &nbsp; &nbsp; 3. Check which samples aren’t labeled.<br>&nbsp; &nbsp; &nbsp; 4. Understand on which groups of samples the model performs poorly and why.<br>&nbsp; &nbsp; &nbsp; 5. Check/Improve whether (human) labeling of samples was done properly.<br>&nbsp; &nbsp; &nbsp; 6. Check whether data or training parameters are biased.<br></p>
                        <h2><strong>Are Generative Models possible in PP-ML?</strong><br><strong>No – they are necessary!</strong></h2>
                        <p>First off, a key question most certainly is, what do generative models have to do in a privacy preserving context? After all, their core objective is to generate data which makes the effect of overfitting/memorization of training samples or parts of training samples even more openly visible. Even normal usage of the model for inference (data generation in this case) without any reverse engineering, etc. could lead to the disclosure of sensitive information. So, training generative models on sensitive data seems to be unwise, even dangerous on the first glance! Counterintuitively however, the approach developed in the paper demonstrates that Generative Models combined with Federated Learning and Differential Privacy can indeed be the solution to the problem of not being able to manually look at the data. Indeed, on a second thought, generative models paired with differential privacy depict the ideal proxy to check for general properties of the data samples as a whole without needing to check out single samples of the real data. In fact, they could possibly even be beneficial to the different tasks of manual inspection debugging as per definition a GM should model inherent characteristics of the whole dataset and not sample-specific details. The same holds for DP, which also tries to hide individual information whilst providing key characteristics of the whole dataset. This prevents <strong>e.g.</strong> that we take a look at a couple of samples that do not exhibit a common error in the dataset and therefore assume a flawless dataset.<br></p>
                        <h2><strong>Bridging the Lab-World with the Real-World.</strong><br><strong>2 real world use-cases.</strong></h2>
                        <p>The above-mentioned paper has explored this concept considering two a<strong>ctual real-world</strong> usecases. The first example debugs the next-word-prediction model which is used in Google GBoard [6] (smart-keyboard) to predict what word the user might want to use next. An RNN on word level is used as a primary model for the prediction task and an RNN on character level is used as the debugging model.<br>The second example is a mobile banking app where a Digit-Classifier allows to automatically read in handwritten digits. A standard CNN is used as primary model for the digit classification and a GAN is used as auxiliary model for debugging.<br>We consider this scenario where the different data sources are users of an app, which uses the primary model to provide some utility.<br><br>We can break down the specifics of the debugging approach and its application to the two use-cases into <strong>three different concepts</strong> building on top of each other.<br></p>
                        <figure style="margin-right: 0;margin-left: 0;width: 100%;"><img class="figure-img" src="assets/img/blog/blog-privacy-preserving-ml/privacy-img2.png"></figure>
                        <figure></figure>
                        <figure></figure>
                        <h4>1. Training generative models in a privacy preserving manner:</h4>
                        <p>The first step obviously is to establish a specific algorithm to train a ML-model in a privacy preserving way on a decentralized dataset. For that we use the so called “DP-FedAvg” [3] algorithm and its adaption to training GANs by the above-mentioned paper. For the sake of this blog, I will only briefly explain the most important parts of this algorithm.<br>To start off, we consider a set of many different data sources (in the app scenario = users) from&nbsp;which we select a new random subset for each training iteration (<strong>i.e. gradient step</strong>). <strong>In parallel</strong>, we send the actual model to each data-source in the subset and update the model parameters while training for a couple of epochs (i.e. iterations on the <strong>whole dataset</strong>). Next, we check the difference between the parameters which were first sent to the data-source and the parameters after the whole training and clip them, if necessary, to a maximum magnitude. This way, after receiving all the weight updates from all the data-sources and <strong>averaging over them</strong>, we make sure all data-sources <strong>contribute roughly equally</strong> to the final global model update.<br><br>Lastly, before actually updating the weights of the model, i.e. doing the gradient step, we add gaussian noise with zero mean and a carefully calculated amount of variance to the weight updates for <strong>differential privacy</strong>.<br>For our GAN the algorithm doesn’t need to be changed much. By definition of our <strong>(ε,δ)-DP</strong>, if a certain operation on data is in a specific DP-bound, further operations stacked on top of this operation have at least the same DP-bounds. As only the training of the GAN-discriminator works on the real data, the training of our GAN-generator <strong>doesn’t require a further DP-step</strong> (added noise) and can be directly trained on the central server (<strong>no FL-procedure</strong> needed).<br></p>
                        <figure style="margin-right: 0;margin-left: 0;width: 100%;"><img class="figure-img" src="assets/img/blog/blog-privacy-preserving-ml/privacy-img3.png"></figure>
                        <h4>2. Generative models as debugging mechanism:</h4>
                        <p>Another key element to successfully debug a certain problem using generative models is the ability to construct a<strong> programmatic selection procedure</strong> which is able to automatically select a suitable subset of the whole training set on which the generative models should train.<br>This means we want to find a standard metric which portrays the performance of the <strong>primary&nbsp;model </strong>on a given subset of the data accurately enough to be able to separate the “bad” data points from the “good” ones without leaking sensitive information about the data-samples themselves. <em>Sounds abstract? Let’s take a look at the examples!</em><br>In the first example we consider a standard problem in the data processing pipeline of an NLP-model, specifically the so called “<strong>tokenization</strong>” which is used to convert words into model inputs, namely vectors. The problem is that a space between two different words isn’t recognized reliably and thus instead of two tokens, one for each word, only one token for the two words is created (see figure below).<br>For the selection procedure, we first track the performance of the <strong>primary </strong>model using a standard metric in NLP, the “<strong>out-of-vocabulary</strong>” (OOV) rate. The OOV rate depicts the number of words (in this case the words generated by the <strong>primary </strong>model for the task of next-word prediction) which are not in the set of known words. Once we recognized that the OOV-rate for the predicted words is unusually high, we suspect that there might be an error in the tokenization (corresponding to the <strong>third problem</strong> defined above *).<br>To investigate this issue, we train another time-series generative model, a char-level-RNN, on exclusively the OOV-words and generate secluded sequences of chars (this means the model also predicts when a char sequence should end, i.e. a word most likely is complete). Next, because the generative model works at char-level, we can calculate the joint character probability allowing us to order the most probable word sequences based on the OOV training. We realize that indeed the most probable word is composed of two known words separated by a space – <strong>we uncovered the tokenization error without looking at a single data sample!</strong></p>
                        <figure style="margin-right: 0;margin-left: 0;width: 100%;"><img class="figure-img" src="assets/img/blog/blog-privacy-preserving-ml/privacy-img4.png"></figure>
                        <p>For the other example we use the <strong>misclassification rate</strong> as a selection metric (corresponding to the <strong>second </strong>and <strong>fourth </strong>problem defined above) to debug a<strong> pixel inversion error</strong> – equally successful!<br></p>
                        <h4>3. Direct examination vs. comparison:</h4>
                        <p>As we consider a low-fidelity generative model, which on top is trained with DP, it seems to be a good idea to opt for <strong>comparison </strong>of the erroneous samples with better performing samples rather than relying on recognizing the bug by only looking at the erroneous samples. In fact, this is exactly what was also done for both examples. In total <strong>we always train four different models</strong>, one good and one bad for the primary and the auxiliary model.<br>Once done, we first compare the performance of the primary models based on the selection metric to check whether there is a bug. If so, we use the selection metric to select a most bad performing subset and a most well performing subset to train the two auxiliary models and to then compare two data samples from these to uncover the bug.<br>To conclude, the approach doesn’t only work<em> utility-wise </em>(we can successfully debug!), but at the same time it allows a <strong>single-digit epsilon privacy budget</strong> given enough users (350,000 for the first example and 2 million for the second, reasonable for such apps!)</p>
                        <h2><strong>So, where can I send-in my naked full body scans?</strong><br></h2>
                        <p>There are two take-home-messages this blog should convey.<br><strong>First</strong>, PP-ML can be made feasible to be actually usable in real-world use-cases – as this example shows, we can even find solutions for challenges that seem to be unsolvable at first. <br><strong>Second</strong>, these examples are a proof-of-concept and not a plug-and-play guide on how to complete the whole machine learning procedure in a privacy preserving fashion. Much work in all of the three fundamental building blocks has still to be done.<br><em>So, what are you waiting for?!</em></p>
                        <h4><strong>References</strong><br></h4>
                        <p>[1] “Generative Models for Effective ML on Private, Decentralized Datasets”, by Sean Augustin et al., published as a conference paper at ICLR 2020<br><br>[2] “Deep Learning with Differential Privacy”, by Martín Abadi et al., published in the proceedings of the 23rd ACM Conference on Computer and Communications Security (CCS 2016)<br><br>[3] “Learning Differential Private Recurrent Language Models”, by H. Brendan McMahan et al., published as a conference paper at ICLR 2018<br><br>[4] “Taxonomy of real faults in deep learning systems “, Nargiz Humbatova, Gunel Jahangirova, Gabriele Bavota, Vincenzo Riccio, Andrea Stocco, and Paolo Tonella. 2019<br><br>[5] https://cs.stanford.edu/people/esteva/nature/<br><br>[6] https://en.wikipedia.org/wiki/Gboard<br></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="footer-basic" style="background-color: #000;margin-top: 40px;padding: 40px;">
        <footer>
            <ul class="list-inline">
                <li class="list-inline-item"><a href="#" data-toggle="modal" data-target="#modal1" style="font-family: Lato, sans-serif;font-size: 20px;">Contact</a></li>
                <li class="list-inline-item"><a href="impressum" style="font-family: Lato, sans-serif;font-size: 20px;">Impressum</a></li>
                <li class="list-inline-item"><a href="datenschutz" style="font-family: Lato, sans-serif;font-size: 20px;">Datenschutz</a></li>
            </ul>
        </footer>
        <p class="copyright" style="font-family: Lato, sans-serif;">TUM.ai © 2020</p>
    </div>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/smart-forms.min.js"></script>
    <script src="assets/js/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="assets/js/script.min.js"></script>
</body>

</html>